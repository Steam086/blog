---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
expert 1 ^eKjVDEK1

expert 2 ^Aes3xRtl

expert 3 ^Ocx8UwC7

expert 4 ^1pXEDED4

这里的每一个方块是一个block_size，路由到expert1 的token按照block_size对齐之后的大小是2个block,在进行专家计算时，先读取sorted_token_ids中的索引，再根据索引读取token的值 ^xQm4u1hz

sorted_token_ids ^5nO6DdVX

%%
## Drawing
```compressed-json
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=
```
%%